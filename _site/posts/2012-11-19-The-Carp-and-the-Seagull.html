<!DOCTYPE html>
<!--
                      __  .__              ________ 
  ______ ____   _____/  |_|__| ____   ____/   __   \
 /  ___// __ \_/ ___\   __\  |/  _ \ /    \____    /
 \___ \\  ___/\  \___|  | |  (  <_> )   |  \ /    / 
/____  >\___  >\___  >__| |__|\____/|___|  //____/ .co.uk 
     \/     \/     \/                    \/        
   -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-gb" class="skrollr skrollr-desktop">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>The Carp and the Seagull</title>
    <meta name="author" content="Benjamin Blundell" />
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Section9 ATOM Feed">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="/css/bootstrap.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/css/s9.css" rel="stylesheet" media="screen">
    <link href="/css/font-awesome.min.css" rel="stylesheet" media="screen">


    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/s9-144.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/s9-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/s9-72.png">
    <link rel="apple-touch-icon-precomposed" href="/images/s9-57.png">
    <link rel="shortcut icon" href="/images/favicon.ico">

    <!-- META DATA - Need to Check and Update -->
    <meta name="google-site-verification" content="Ew7bGq_-B5Djz3nNvxYt6abpW2fUBOU-rFKrlvIQwiU" /> 

    <!-- General metadata -->
    <meta name="generator" content="" />
    <meta name="robots" content="index,follow" />
    <meta name="revisit-after" content="2 days" />
    <meta name="Author-Template" content="" />
    <meta name="Author" content="Benjamin Blundell" />
    <meta name="Publisher" content="Benjamin Blundell" />
    <meta name="Publisher-Email" content="ben@section9.co.uk" />
    <meta name="Coverage" content="UK" /> 

    <!-- Dublin Core Metadata -->
    <meta name="DC.creator" lang="en" content="Benjamin Blundell" />
    <meta name="DC.date.created" lang="en" content="" />
    <meta name="DC.format" lang="en" content="text/html" />
    <meta name="DC.language" content="en" />
    <meta name="DC.publisher" lang="en" content="Benjamin Blundell" />
    <meta name="DC.rights.copyright" lang="en" content="Benjamin Blundell" />
    <meta name="DC.coverage" lang="en" content="" />
    <meta name="DC.identifier" content="" />    

    <!-- eGMS Metadata -->
    <meta name="eGMS.status" lang="en" content="V1.0 Public Consumption" />

    <meta name="Keywords" content="opengl, webgl, coffeescript, git, hpc, kinect, opengl, cinder,openframeworks, cpp, c++, programming, graphics, art, design, code" />
    <meta name="Description" content="Benjamin Blundell, section9 dot co dot uk, the home of Benjamin Blundell. I make things with computers"/>
    <meta name="DC.title" lang="en" content="section9 dot co dot uk - Benjamin Blundell" />
    <meta name="DC.description" lang="en" content="" />
    <meta name="DC.subject" lang="en" content="" /> 

    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/skrollr.min.js"></script>


  </head>

  <body>

    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <img class="navbar-brand-image" src="/images/s9_tiny.png" alt="section9 logo" />

          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/index.html">Benjamin J. Blundell</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li ><a href="/index.html">Home</a></li>
            <li ><a href="/blog.html">Blog</a></li>
            

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="true">Professional Work <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/posts/2014-12-21-Utopia.html">UTOPIA Bio-informatics Toolkit</a></li>
                
                
                
                
                
                
                <li><a href="/posts/2014-12-12-Bullseye.html">Bullseye's playground for Target and Psyop</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/posts/2014-09-26-Echo-Forms-Live-Gig.html">Echoforms at Lexus NX Launch</a></li>
                
                
                
                
                
                
                <li><a href="/posts/2014-09-06-900-Pixel-Screen.html">900 RGB LED Screen</a></li>
                
                
                
                
                
                
                
                
                <li><a href="/posts/2014-07-28-Kaleidoscope.html">Kaleidoscope for Lexus</a></li>
                
                
                
                
                
                
                <li><a href="/posts/2014-05-28-Equatorie.html">The Equatorie</a></li>
                
                
                
                
                
                
                
                
                <li><a href="/posts/2014-02-13-Phantom-Limb-Oculus.html">Oculus Rift, meet Phantom Limb Therapy</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/posts/2013-08-06-Photorealistic-Hands.html">Photo-realistic hands</a></li>
                
                
                
                
                
                
                <li><a href="/posts/2013-07-12-BurberryKisses.html">Burberry Kisses, with Google and Grow Interactive</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/posts/2013-04-08-Museum-of-Rural-Life.html">Museum of Rural Life Smart Audio Guide</a></li>
                
                
                
                
                
                
                
                
                <li><a href="/posts/2013-02-18-BritishMuseumCoins.html">Coin Detection at the British Museum</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/posts/2012-11-19-The-Carp-and-the-Seagull.html">The Carp and the Seagull</a></li>
                
                
                <li class="divider"></li>
                <li><a href="/work.html">...and more!</a></li>

              </ul>
            </li>

            <li class="dropdown">
              <a href="/work.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="true">Fun Experiments <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">



                <li><a href="#">Asteroids</a></li>
                <li><a href="#">EchoForms</a></li>
                <li><a href="#">Amiga Bouncing Ball</a></li>


              </ul>
            </li>

            <li ><a href="/about.html">About</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="jumbotron">
      <div class="container">
        <h2>The Carp and the Seagull</h2>
        <h3>19-11-2012</h3>
        <p>An interactive movie, in WebGL, with Nexus Interactive</p>
      </div>
    </div>

    <div class ="container" id="content">
      <div class="col-md-9">

        
<p><img alt="carp" src="http://farm9.staticflickr.com/8483/8198734967_a160a30da6.jpg" /></p>
<p>Recently, for the past 2 months, I've been involved with a company called
<a href="http://www.nexusinteractivearts.com/">Nexus Interactive Arts</a> on a webgl
project called <a href="http://www.thecarpandtheseagull.com">The Carp and the Seagull</a>.
Its an interactive movie directed by Evan Boehm and its rather good.</p>
<p>The story revolves around our chap, Masato. He is a fisherman who is doomed,
basically. The story is told in 4 chapters inside a cube. As the cube is spun
we see the real world and the netherworld, lighting strikes, fish jump and our
fisherman fishes. The story is a classic tale of one man's life going wrong. </p>
<p>The technical challenges on this project were considerable. Initially, I was
brought in on the assets. How do you deal with animation from a production
studio in a webbrowser? Nexus has a whole fleet of professional animators
working in 3dsmax, maya and all the rest. The animation in this movie is
excellent, but the problem with animation is the filesize. </p>
<p>Initially, we tried using skeletal animation; exporting the fbx file and
attempting to parse it in python, converting to JSON. This proved very tricky
and in the end, what we had were glitches.</p>
<p>Shame really, because skeletal animation uses less space and has the ability to
be deformed on the fly. In the end we decided to settle with morph targets. The
problem with morph targets however, is they are essentially a new set of vertex
positions everyframe. Uncompressed JSON for one character using JSON in the
three.js format would weigh in at around 8 megabytes! Quite the challenge.</p>
<p><img alt="gitch" src="http://farm9.staticflickr.com/8066/8198670489_1541505bdf.jpg" /></p>
<p>How do you get from 3DSMax to Three.js JSON format though? The answer, it
seems, is not easily. We decided to go with the venerable MD2 format. There is
<a href="http://thegreystudios.com/blog/?p=278">an exporter for max</a> that will spit out
MD2 files. Writing a python convertor from MD2 to JSON worked a treat. Now we
had a way to combine animations from different files, export the various
animations and create the lovely assets.</p>
<p><img alt="glitch" src="http://farm9.staticflickr.com/8203/8199825074_d377399ce6.jpg" /></p>
<p>My first solution was to use GZip compression on the fly. In addition, I
modified the three.js format to encompass multiple models in one file; a sort
of library if you will. This managed to get the filesize and number of requests
down considerably at the cost of some processing time.</p>
<p>Another chap, the lovely <a href="http://www.roxlu.com/">Roxlu</a> came up with a simple
binary format for our files. I wrote a quick JSON to binary python script and
meshed it with Roxlu's loader. The compression rate was comparable, if not
better than using gzip.</p>
<div class="clearfix"></div>

<p>With the assets out of the way, the rest was down to the arts team. I spent
most of my time adding extra functionality, fixing bugs and working with the
remaining javascript. Three.js is quite a good library. There are a few
problems with it; documentation being one of them. I missed the fact that was a
handy class for generating vertex normals - would have been handy but it was
burried in an example.</p>
<p>One problem we had, and in fact, all Mac Users will have, is to do with
Anti-Aliasing. Given that the art in this project uses a lot of lines, the lack
of antialiasing was going to be a killer. Only certain cards would do this.
Annoyingly, there is no way to test for whether or not this has been enabled.
In the end, the plan was simple; render a small 4 x 4 area of the screen with a
line and then sample part of it. If you see any grey, you know you have
antialiasing enabled. This seemed to work and was quite a nice fix.</p>
<p>FXAA is supported in three.js through the FXComposer - a really nice class that
allows many screen based effects to be stacked together. In the end, we decided
not to use it as the effect didn't look too great. In addition, there is a
fault with certain machines and setting the line width in WebGL - lines can
only be drawn with a thickness of 1. This means you dont have anything to blend
with.</p>
<p>Three.js is a good library. Some of the good things are the uber-shader, the
idea of shared geometry and the FXComposer. Initially I was skeptical with the
material paradigm but actually, it works quite well. The maths library is not
so intuitive sadly and the animation format is still in its early stages but
overall, a nice library to work with.</p>
<p>Working for a client like Nexus is quite tough but enjoyable. As the project
progressed a learnt a little more about how a WebGL application might be
structured and the weaknesses of javascript. There is quite a bit I'd do
differently next time. I think finishing my CoffeeGL library might be a good
start.</p>
      </div>

      <div class="col-md-3">
        <ul class="list-unstyled">
          
          <li><a href="/posts/2010-07-20-animation10.html">Animation10</a></li>
          
          <li><a href="/posts/2010-10-15-british-library-tweet-o-meter.html">British Library Tweet-o-meter</a></li>
          
          <li><a href="/posts/2011-04-13-the-woes-of-soft-shadows.html">The Woes of Soft Shadows</a></li>
          
          <li><a href="/posts/2011-05-24-My-First-Big-Thing-Deutsche-Bank.html">Deutsche Bank Installation</a></li>
          
          <li><a href="/posts/2011-06-15-only.html">Only Installation at the Lowry</a></li>
          
          <li><a href="/posts/2011-11-09-Smiling-Film-Student-Geekery.html">Smiling-Film-Student-Geekery</a></li>
          
          <li><a href="/posts/2011-12-05-Lowry-to-Life.html">Lowry to Life</a></li>
          
          <li><a href="/posts/2012-02-3-Phantom-Limb.html">Phantom Limb Pain</a></li>
          
          <li><a href="/posts/2012-08-10-Boom-Box.html">Animation12 - The Boom Box!</a></li>
          
          <li><a href="/posts/2012-08-17-Organ-Reconstruction.html">3D Organ Reconstruction</a></li>
          
          <li><a href="/posts/2013-02-18-BritishMuseumCoins.html">Coin Detection at the British Museum</a></li>
          
          <li><a href="/posts/2013-04-08-Museum-of-Rural-Life.html">Museum of Rural Life Smart Audio Guide</a></li>
          
          <li><a href="/posts/2013-07-12-BurberryKisses.html">Burberry Kisses, with Google and Grow Interactive</a></li>
          
          <li><a href="/posts/2013-08-06-Photorealistic-Hands.html">Photo-realistic hands</a></li>
          
          <li><a href="/posts/2013-11-25-Phantom-Limb-01.html">Phantom Limb Dev Diary Part 1</a></li>
          
          <li><a href="/posts/2014-01-12-Phantom-Limb-02.html">Phantom Limb Dev Diary Part 2</a></li>
          
          <li><a href="/posts/2014-01-28-Phantom-Limb-03.html">Phantom Limb Dev Diary Part 3</a></li>
          
          <li><a href="/posts/2014-02-05-Phantom-Limb-04.html">Phantom Limb Dev Diary Part 4</a></li>
          
          <li><a href="/posts/2014-02-13-Phantom-Limb-Oculus.html">Oculus Rift, meet Phantom Limb Therapy</a></li>
          
          <li><a href="/posts/2014-05-28-Equatorie.html">The Equatorie</a></li>
          
          <li><a href="/posts/2014-07-28-Kaleidoscope.html">Kaleidoscope for Lexus</a></li>
          
          <li><a href="/posts/2014-09-26-Echo-Forms-Live-Gig.html">Echoforms at Lexus NX Launch</a></li>
          
          <li><a href="/posts/2014-12-12-Bullseye.html">Bullseye's playground for Target and Psyop</a></li>
          
          <li><a href="/posts/2014-12-21-Utopia.html">UTOPIA Bio-informatics Toolkit</a></li>
          
          <li><a href="/posts/2014-12-30-Tetris.html">Giant Tetris on a building; RI Xmas Lectures</a></li>
          
          <li><a href="/posts/2011-08-14-Denied.html">Denied</a></li>
          
        </ul>
      </div>


    </div>


    <footer>

      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <h3>Ghost in the CSh</h3>
            <p>© Benjamin J. Blundell 2015 - <a style="color: white" title="Share &amp; Enjoy — CC-BY" href="https://creativecommons.org/licenses/by/3.0/">CC-BY</a> <a href="/atom.xml" title="RSS"><i class="fa fa-rss"></i></a></p>

          </div>
          <div class="col-md-4">
            <h3>Other places</h3>
            <p class="places-icons">
              <a href="https://github.com/OniDaito" title="GitHub"><i class="fa fa-github"></i></a>
              <a href="http://stackoverflow.com/users/104324/oni" title="Stack-Overflow"><i class="fa fa-stack-overflow"></i></a>
              <a href="https://www.flickr.com/photos/section9/" title="Flickr"><i class="fa fa-flickr"></i></a>
              <a href="https://www.youtube.com/user/onidaito/videos" title="Youtube"><i class="fa fa-youtube"></i></a>
              <a href="https://vimeo.com/user1678273/videos" title="Vimeo"><i class="fa fa-vimeo-square"></i></a>
            </p>
          </div>
          <div class="col-md-4">
            <h3>Contact</h3>
            <p class="places-icons">
             <a href="http://www.twitter.com/secti0n9" title="Twitter"><i class="fa fa-twitter"></i></a>
             <a href="mailto:ben@section9.co.uk" title="Email"><i class="fa fa-envelope-square"></i></a>
             <a href="https://uk.linkedin.com/in/section9" title="LinkedIn"><i class="fa fa-linkedin"></i></a>
             <a href="https://www.facebook.com/benjamin.blundell" title="Facebook"><i class="fa fa-facebook"></i></a>
             <a href="https://plus.google.com/u/0/+BenjaminBlundell/posts" title="Google Plus"><i class="fa fa-google-plus"></i></a>
             <a href="/key.html" title="GPG Key"><i class="fa fa-lock"></i></a>
           </p>
         </div>
       </div>


     </footer>
   </div>


  <script type="text/javascript">
    $(window).load(function(){

    // Process all images in the post for  left / right align
    var images = $("#content img");
    for(var i = 0; i < images.length; i++) {
      if (i % 2 == 0){
        $(images[i]).addClass("img-responsive img-thumbnail pull-left");
      } else {
        $(images[i]).addClass("img-responsive img-thumbnail pull-right");
      }
    }
  });
  </script>

  </body>
</html>

