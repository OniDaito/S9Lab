<p>Recently, I&#8217;ve been working with a good client on a project that requires network communication between two sites and provision for a history feature. One of the collaborators is a fan of <a href='http://www.mongodb.org/'>mongodb</a> and <a href='http://nodejs.org/'>nodejs</a> - two rather nifty projects that I&#8217;ve been meaning to work with for a while. I had no idea but dived in anyway.</p>

<p>Node appears to have a set of modules which you can install with <a href='http://npmjs.org/'>npm</a>. These modules are placed within the directory in which you run npm which is presumably where your node script is. One useful modules is <a href='http://expressjs.com/'>express</a> which sets up basic handling for a website. You can then write code such as:</p>

<pre><code>var Express = require(&#39;express&#39;);
var app = Express.createServer();

app.get(&#39;/&#39;, function(req, res){
	res.send(&#39;Hello World&#39;);
});

app.listen(3001);</code></pre>

<p>Of course, post requests, paths and all the usual gubbins are supported.</p>

<p>Mongo has a set of drivers that work with node as well. I used the <a href='https://github.com/christkv/node-mongodb-native'>Mongodb native driver</a> which seemed pretty good, <em>except</em> for one important thing - the syntax is not quite the same as the examples given on the mongodb website. It took me sometime to realise why my queries weren&#8217;t working.</p>

<pre><code>var Db = require(&#39;mongodb&#39;).Db;
var Connection = require(&#39;mongodb&#39;).Connection;
var Server = require(&#39;mongodb&#39;).Server;

var client = new Db(&#39;testing&#39;, new Server(&quot;127.0.0.1&quot;, 27017, {})),
	test = function (err, collection) {
	var Figure = {id: 1, limbs : [ [1.0,5.0,10.0] , [-1,1,1]  ] };
	collection.insert( Figure , function(err, docs) {

    	// Locate all the entries using find
    	collection.find().toArray(function(err, results) {
			console.log(results);    
			// Let&#39;s close the db
			client.close();
    	});
	});
};

client.open(function(err, p_client) {
	client.collection(&#39;test_insert&#39;, test);
});</code></pre>

<p>You can install mongodb with <a href='https://github.com/mxcl/homebrew'>homebrew</a> and run it locally on a mac with</p>

<pre><code>sudo mongod run --config /usr/local/Cellar/mongodb/1.8.1-x86_64/mongod.conf</code></pre>

<p>Fairly straight forward. Sadly, for use in this project, it turned out that using boost::asio with tcp::iostreams are superior. I still haven&#8217;t managed to work with streams in nodejs yet, though they do exist.</p>